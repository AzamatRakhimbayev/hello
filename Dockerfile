# Используем официальный образ Golang в качестве базового
FROM golang:1.21-alpine AS builder

# Устанавливаем рабочую директорию внутри контейнера
WORKDIR /app

# Копируем только исходный код приложения
COPY main.go .
# (Добавь другие .go файлы, если есть)

# Собираем Golang-приложение
RUN go build -o myapp main.go

# Создаем минимальный образ для запуска приложения
FROM alpine:latest
WORKDIR /root/

# Копируем скомпилированный исполняемый файл из builder-образа
COPY --from=builder /app/myapp ./myapp

# Указываем команду для запуска приложения
CMD ["./myapp"]

# (Опционально) Открываем порт, если приложение слушает сетевые соединения
# EXPOSE 8080